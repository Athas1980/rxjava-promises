import com.darylteo.gradle.plugins.*
import com.darylteo.gradle.plugins.vertx.*

buildscript {
  repositories {
    mavenLocal() // testing purposes only
    mavenCentral()
  }

  dependencies {
    classpath 'com.darylteo:maven-plugin:1.1.0-ALPHA1-SNAPSHOT'
    classpath 'com.darylteo:vertx-gradle-plugin:1.1.0-ALPHA1-SNAPSHOT'
  }
}

subprojects {
  apply plugin: MavenPlugin

  dependencies { testCompile "junit:junit:$junitVersion" }
  
  maven {
    release = project.hasProperty('release') ? project.release : false

    username = sonatypeUsername
    password = sonatypePassword

    repository = 'https://oss.sonatype.org/service/local/staging/deploy/maven2/'
    snapshotRepository = 'https://oss.sonatype.org/content/repositories/snapshots/'
  }
}

[
  ':vertx-promises',
  ':vertx-promises-js'
]
.collect { project(it) }
.each { project ->
  project.with {
    apply plugin: VertxProjectPlugin
    apply plugin: VertxPublishPlugin

    vertx {
      version = vertxVersion
      config { }
    }
  }
}